<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="noindex" />
    <title>Content Manager</title>
    
    <!-- Custom styles for prose/markdown content -->
    <style>
      /* Prose styling for markdown content */
      .prose {
        color: #374151;
        max-width: 65ch;
      }
      .prose h1 {
        font-size: 2.25em;
        font-weight: 800;
        line-height: 1.1111111;
        margin-top: 0;
        margin-bottom: 0.8888889em;
      }
      .prose h2 {
        font-size: 1.5em;
        font-weight: 700;
        line-height: 1.3333333;
        margin-top: 2em;
        margin-bottom: 1em;
      }
      .prose h3 {
        font-size: 1.25em;
        font-weight: 600;
        line-height: 1.6;
        margin-top: 1.6em;
        margin-bottom: 0.6em;
      }
      .prose p {
        margin-top: 1.25em;
        margin-bottom: 1.25em;
        line-height: 1.75;
      }
      .prose a {
        color: #111827;
        text-decoration: underline;
        font-weight: 500;
      }
      .prose strong {
        font-weight: 600;
        color: #111827;
      }
      .prose ul, .prose ol {
        margin-top: 1.25em;
        margin-bottom: 1.25em;
        padding-left: 1.625em;
      }
      .prose li {
        margin-top: 0.5em;
        margin-bottom: 0.5em;
      }
      .prose blockquote {
        font-weight: 500;
        font-style: italic;
        color: #111827;
        border-left-width: 0.25rem;
        border-left-color: #e5e7eb;
        quotes: "\201C""\201D""\2018""\2019";
        margin-top: 1.6em;
        margin-bottom: 1.6em;
        padding-left: 1em;
      }
      .prose code {
        color: #111827;
        font-weight: 600;
        font-size: 0.875em;
      }
      .prose pre {
        color: #e5e7eb;
        background-color: #1f2937;
        overflow-x: auto;
        font-weight: 400;
        font-size: 0.875em;
        line-height: 1.7142857;
        margin-top: 1.7142857em;
        margin-bottom: 1.7142857em;
        border-radius: 0.375rem;
        padding: 0.8571429em 1.1428571em;
      }
      .prose img {
        margin-top: 2em;
        margin-bottom: 2em;
      }
      .prose-lg {
        font-size: 1.125rem;
        line-height: 1.7777778;
      }
      .prose-lg p {
        margin-top: 1.3333333em;
        margin-bottom: 1.3333333em;
      }
      .prose-lg h1 {
        font-size: 2.6666667em;
        margin-top: 0;
        margin-bottom: 0.8333333em;
        line-height: 1;
      }
      .prose-lg h2 {
        font-size: 1.6666667em;
        margin-top: 1.8666667em;
        margin-bottom: 1.0666667em;
        line-height: 1.3333333;
      }
      .prose-lg h3 {
        font-size: 1.3333333em;
        margin-top: 1.6666667em;
        margin-bottom: 0.6666667em;
        line-height: 1.5;
      }
    </style>
  </head>
  <body>
    <!-- Include the script that builds the page and powers Decap CMS -->
    <script src="https://unpkg.com/decap-cms@^3.0.0/dist/decap-cms.js"></script>
    
    <!-- Custom preview templates -->
    <script>
      // Register styles for preview iframe - using specific CSS chunks
      CMS.registerPreviewStyle("/_next/static/chunks/5d7eabfae8fd2f82.css", { raw: false });
      CMS.registerPreviewStyle("/_next/static/chunks/b9fc0b61b038f907.css", { raw: false });
      
      // Assignment Preview - matches live assignment page layout
      const AssignmentPreview = createClass({
        render: function() {
          const entry = this.props.entry;
          const title = entry.getIn(['data', 'title']) || 'Untitled';
          const coverImage = entry.getIn(['data', 'coverImage']) || '';
          const coverImagePosition = entry.getIn(['data', 'coverImagePosition']) || 'center';
          const body = this.props.widgetFor('body');

          // Convert relative paths to absolute URLs
          const imageUrl = coverImage.startsWith('http') ? coverImage : `https://artbyt-web.vercel.app${coverImage}`;

          const positionMap = {
            'top': 'top',
            'bottom': 'bottom',
            'left': 'left',
            'right': 'right',
            'center': 'center',
            'top left': 'left top',
            'top right': 'right top',
            'bottom left': 'left bottom',
            'bottom right': 'right bottom',
          };
          const objectPosition = positionMap[coverImagePosition] || 'center';

          return h('div', { className: 'max-w-4xl mx-auto px-6 py-8' },
            h('article', {},
              // Header section
              h('div', { className: 'mb-8 md:mb-16' },
                h('h1', { className: 'text-5xl md:text-7xl lg:text-8xl font-bold tracking-tighter leading-tight md:leading-none mb-12 text-center md:text-left' }, title),
                coverImage && h('div', { className: 'mb-8 md:mb-16 relative w-full overflow-hidden rounded-lg', style: { aspectRatio: '16/9' } },
                  h('img', {
                    src: imageUrl,
                    alt: title,
                    className: 'w-full h-full object-cover rounded-lg',
                    style: { objectPosition: objectPosition }
                  })
                )
              ),
              // Body section
              h('div', { 
                className: 'prose prose-lg prose-slate max-w-none',
                style: {
                  fontSize: '1.125rem',
                  lineHeight: '1.75rem'
                }
              }, body)
            )
          );
        }
      });

      // Homepage Preview - matches live homepage with all sections
      const HomepagePreview = createClass({
        render: function() {
          const entry = this.props.entry;
          const intro = entry.getIn(['data', 'intro']);
          const title = intro?.get('title') || 'ArtByT';
          const subtitle = intro?.get('subtitle') || 'Din lokala designstudio';
          const description = intro?.get('description') || '';
          const primaryButton = intro?.get('primaryButton');
          const secondaryButton = intro?.get('secondaryButton');
          const featuredAssignment = entry.getIn(['data', 'featuredAssignment']) || '';
          const moreStories = entry.getIn(['data', 'moreStories']) || [];

          return h('div', {},
            // Intro Section
            h('div', { className: 'relative isolate px-6 lg:px-8' },
              h('div', { className: 'mx-auto max-w-4xl py-16 sm:py-24 lg:py-32' },
                h('div', { className: 'text-center' },
                  h('h1', { className: 'text-5xl font-bold tracking-tight text-gray-900 sm:text-7xl lg:text-8xl' }, subtitle),
                  h('p', { className: 'mt-2 text-2xl font-semibold text-gray-900 sm:text-3xl' }, title),
                  description && h('p', { className: 'mt-8 text-xl leading-relaxed text-gray-600 max-w-2xl mx-auto' }, description),
                  h('div', { className: 'mt-12 flex flex-col sm:flex-row items-center justify-center gap-4' },
                    primaryButton && h('div', { className: 'w-full sm:w-auto rounded-md bg-gray-900 px-8 py-3.5 text-base font-semibold text-white shadow-sm hover:bg-gray-800 transition-colors cursor-pointer' },
                      primaryButton.get('text') || 'Primary Button'
                    ),
                    secondaryButton && h('div', { className: 'w-full sm:w-auto rounded-md border border-gray-900 px-8 py-3.5 text-base font-semibold text-gray-900 hover:bg-gray-50 transition-colors cursor-pointer' },
                      secondaryButton.get('text') || 'Secondary Button'
                    )
                  )
                )
              )
            ),
            // Featured Assignment Section
            featuredAssignment && h('div', { className: 'max-w-4xl mx-auto px-6 mb-24 md:mb-32' },
              h('div', { className: 'mb-8' },
                h('h2', { className: 'text-3xl md:text-4xl font-bold tracking-tight mb-2' }, 'Utvalt projekt'),
                h('p', { className: 'text-lg text-gray-600' }, 'Ett urval av mitt senaste arbete')
              ),
              h('div', { className: 'bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow' },
                h('div', { className: 'aspect-[16/9] bg-gray-200 flex items-center justify-center' },
                  h('p', { className: 'text-gray-500 text-sm' }, 'Bild för projekt')
                ),
                h('div', { className: 'p-6' },
                  h('h3', { className: 'text-2xl font-bold mb-3' }, featuredAssignment),
                  h('p', { className: 'text-gray-600 mb-4' }, 'Projektbeskrivning visas här när sidan publiceras'),
                  h('div', { className: 'inline-block text-gray-900 font-semibold hover:underline' }, 'Läs mer →')
                )
              )
            ),
            // More Assignments Section
            moreStories.size > 0 && h('div', { className: 'max-w-4xl mx-auto px-6 mb-24 md:mb-32' },
              h('h2', { className: 'text-3xl md:text-4xl font-bold tracking-tight mb-12 text-center' }, 'Fler projekt'),
              h('div', { className: 'grid grid-cols-1 md:grid-cols-2 gap-8' },
                moreStories.map(function(slug) {
                  return h('div', { className: 'bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow', key: slug },
                    h('div', { className: 'aspect-[16/9] bg-gray-200 flex items-center justify-center' },
                      h('p', { className: 'text-gray-500 text-sm' }, 'Bild')
                    ),
                    h('div', { className: 'p-6' },
                      h('h3', { className: 'text-xl font-bold mb-2' }, slug),
                      h('p', { className: 'text-gray-600 text-sm' }, 'Projektbeskrivning'),
                      h('div', { className: 'mt-3 inline-block text-gray-900 font-semibold text-sm hover:underline' }, 'Läs mer →')
                    )
                  );
                }).toArray()
              )
            ),
            // Testimonials placeholder
            h('div', { className: 'max-w-4xl mx-auto px-6 mb-24 md:mb-32' },
              h('h2', { className: 'text-3xl md:text-4xl font-bold tracking-tight mb-12 text-center' }, 'Kundrecensioner'),
              h('p', { className: 'text-gray-600 text-center' }, 'Recensioner från nöjda kunder')
            ),
            // Portfolio Gallery placeholder
            h('div', { className: 'max-w-4xl mx-auto px-6 mb-24 md:mb-32' },
              h('h2', { className: 'text-3xl md:text-4xl font-bold tracking-tight mb-12 text-center' }, 'Portfolio'),
              h('p', { className: 'text-gray-600 text-center' }, 'Ett urval av mina bästa arbeten')
            )
          );
        }
      });

      // About Preview - matches live about page layout
      const AboutPreview = createClass({
        render: function() {
          const entry = this.props.entry;
          const title = entry.getIn(['data', 'title']) || 'Om Mig';
          const image = entry.getIn(['data', 'image']) || '';
          const imagePosition = entry.getIn(['data', 'imagePosition']) || 'center';
          const body = this.props.widgetFor('body');

          // Convert relative paths to absolute URLs
          const imageUrl = image.startsWith('http') ? image : `https://artbyt-web.vercel.app${image}`;

          const positionMap = {
            'top': 'top',
            'bottom': 'bottom',
            'left': 'left',
            'right': 'right',
            'center': 'center',
            'top left': 'left top',
            'top right': 'right top',
            'bottom left': 'left bottom',
            'bottom right': 'right bottom',
          };
          const objectPosition = positionMap[imagePosition] || 'center';

          return h('div', { className: 'mx-auto max-w-4xl px-6 py-8' },
            h('h1', { className: 'text-4xl md:text-5xl lg:text-6xl font-bold tracking-tight text-gray-900 mb-12' }, title),
            h('div', { className: 'grid grid-cols-1 md:grid-cols-2 gap-8 mb-12' },
              image && h('div', { className: 'relative rounded-lg overflow-hidden', style: { aspectRatio: '1/1' } },
                h('img', {
                  src: imageUrl,
                  alt: title,
                  className: 'w-full h-full object-cover',
                  style: { objectPosition: objectPosition }
                })
              ),
              h('div', { 
                className: 'flex flex-col justify-center prose prose-lg prose-slate max-w-none',
                style: {
                  fontSize: '1.125rem',
                  lineHeight: '1.75rem'
                }
              }, body)
            )
          );
        }
      });

      // Register preview templates
      CMS.registerPreviewTemplate('assignments', AssignmentPreview);
      CMS.registerPreviewTemplate('homepage', HomepagePreview);
      CMS.registerPreviewTemplate('about', AboutPreview);
    </script>
  </body>
</html>
